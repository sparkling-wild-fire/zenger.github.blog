# 环境部署

所需资料：服务部署代码+前端代码（不管）+中间件

## 中间件
- fdfs
- redis+mysql+nginx(fastdfs_nginx_module)
- FastCGI (解决nginx只能静态调用的问题)

## 项目架构

文件服务器项目架构：

<img src="https://cdn.jsdelivr.net/gh/sparkling-wild-fire/picgo@main/blogs/pictures/20230331162443.png" alt="20230331162443" width="850">

使用场景：
- 网盘（现在已经被垄断了）
- 双十一：图片如果存在数据库上，而数据库存在磁盘上，那么一定会很慢，所以需要存到文件服务器上

文件服务器为啥快？

各模块作用：
1. 客户端：
   - B/S:必须使用http协议
   - C/S:协议任意，QT客户端可使用http协议
2. 服务器：
    - nginx：
      - 能处理静态请求(html，jpg)，动态请求无法处理；
      - 反向代理服务器：
        - 客户端不能直接访问web服务器，访问的是反向代理服务器
        - 这样是防止用户将请求都集中发送到一台nginx节点服务器，所以反向代理服务器向用户屏蔽了nginx集群，并将请求负载均衡地发送到nginx节点
      - 服务器集群之后，每台服务器上部署的内容必须相同
    - fastCGI:帮助服务器处理动态请求
- nginx:nginx结合CGI完成动态请求的处理，比如login，访问的login.xml是静态的，但是用户递交的登陆信息是不同的，是动态的
，nginx发分发给不同的CGI进行处理
  - 小巧高效的HTTP服务器（解析HTTP协议），如果服务器满足不了网络并发要求，那就建个nginx集群
  - 高效的负载均衡反向代理
- mysql：在磁盘上，存文件的属性，所有者，大小等
- redis：缓存，存储经常要从磁盘读取的数据
- FASTDFS分布式文件服务器：存文件内容，提供下载

学框架的时候不应该再为一些线程，进程的原理阻扰了，而应该注重实现逻辑
