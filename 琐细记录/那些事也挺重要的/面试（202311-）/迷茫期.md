# 面试

这一段项目经历吃大亏，不知道怎么去阐述

说的东西面试官都一面蒙蔽

## 腾讯云
- 偏底层  c++ 11
- 简历上写单例类，面试官让我写，没写出来
- ET 和 LT 的区别

## 海康威视

- zk怎么用来做灾备
- 微服务怎么调度
- 对底层有什么理解：如内存池、设计模式，我只回答了两种设计模式（我自己还不太常用），都没回答内存池
- 不能说没有一个很好的平台、都去做业务了...
- 为什么要离开恒生

## bigo

- 为什么一年半就要离开
- 中间件有没有比较熟的
- 消息节点是基于RabbitMq的吗，消息节点挂了怎么办，消息节点的灾备怎么做
- zookeeper为什么可以做注册中心，最重要的是它的一致性？
- 公司的线程池是怎么实现的？
- 实现的策略有没有你熟悉的，有没有遇到什么问题？
- [做个题吧](https://leetcode.cn/problems/binary-tree-right-side-view/)

这题用层次遍历吧？除了层次遍历，有没有更好的办法=> 没有，层次遍历也没写出来

bigo的面试官给人的体验很好，虽然我已经汗流浃背了，但确实没有任何压力。。。  =》我忘记问更优的方法是啥了！

## 木牛一心

做机器人的一家公司，7月份成立

三十分钟自己做题，也不怕你百度ai啥的，然后直接问题目，都是偏底层一点的细节

````text
1.  char a[10] = {0, 1,2,3,4,5,6,7}; int* p = (int*)a;
*(short int*)(p++) = ?
我的回答：45
考点：
1. p++和++p
2. 大小端（ai抄的）
3. 二字节的short int 二进制转十进制

2.  简述 std::vector 与 std::list 的区别以及在使用中如何选择。
3.  int main  () {
std::string a = “123”;
return 0;
}
本代码在运行中内存如何分配？哪些存在堆上，哪些存在栈上，是否还使用了其他空间。

我的回答：a在堆上，因为是用new分配的，但如果是字符数组，那就是栈上了，main分配在函数调用栈上

4.      std::string a=“123”;
std::string b = std::move(a);
请问 std::move 执行时内存发生了什么变化，a ，b 是否还能能够访问。
5.  是否使用过 gdb 或者其他 IDE 的调试界面，请简述什么是调用栈  (call stack 窗口或 backtrace 命令) 。
6.    int a=0;//定义全局变量 a void funcAdd()
{
a++;
}
1)  开启 100 个线程运行 funcAdd 函数，所有线程执行结束后 a=？
2)  以上代码在一个单核单线程的 CPU 上运行与一个多核多线程的 CPU 上运行是否有区别，
为什么？

我的回答：
一开始审题没仔细，没注意a是个全局变量，然后说a的值不确定，面试官说具体的范围,我说小于等于100
单核等于100，多核可能被其他线程影响，如其他线程也在修改a的值，但我没想到加锁这方面

1）考点：a++为非原子操作，是4条操作指令集，可能在执行第二条指令时，被其他线程中断了，导致无效累加，结果小于等于100
2）考点：单核多核结果a的值都可能被影响，单核可能发生系统中断（中断很容易发生，但仅针对a++这个操作不会），多核的话可能被其他线程干扰，需要加锁


7.  模板类的实现代码与定义代码是否可拆分为cpp 文件与 h 文件，为什么？
8.    请简述链接的过程，请简述动态连接与静态链接的区别。
````

这家小公司整体来说，感觉能过。


## 富途

### 刷面经

3. 已知c++中max宏定义如下：
#define max(a,b) (a>b?a:b)
请参考max宏定义写出取中间值的宏
#define midian(a, b, c)

看起来简单，我的写法是max(min(a,b),c)  

但是当a=b<c时，我会把c当成中间值返回，所以需要更正 =》 根本上就错了，如果c是最大值，那就g了

所以：min(max(a,b),max(min(a,b),c))

4. 在一个字符串中，找出不包含重复字符的最长子字符串的长度
aa => a => 1
abacadaf=>bac=>3
abcd => abcd => 4
abcdaf => bcdaf => 5
afbcdef => afbcde => 6

双指针+哈希：这里left这个边界没考虑清楚，话了较多时间调试

```c++
class Solution {
public:
    int lengthOfLongestSubstring(string s) {
        map<char,int> idxMap;    // 这里也可以用26长度数组
        int slen=s.length();
        int left=0;
        int curLen=0,maxLen=0;
        for(int i=0;i<slen;++i){   // i是右指针
            if(idxMap.count(s[i])==1){   // 如果哈希记录了这个,这个语句块不考虑i处的字符
                int preIdx=idxMap[s[i]];
                if(preIdx>=left){   // 不在滑动窗口内
                    // 开始新的遍历，从重复字符处开始
                    curLen=curLen-(preIdx-left+1);
                    left=preIdx+1;
                }
            }
            curLen++;
            maxLen=max(curLen,maxLen);
            idxMap[s[i]]=i;    // 更新该字符最近出现的位置
        }
        return maxLen;
    }
};
```

[算法：子集](https://www.nowcoder.com/share/jump/1709905961702707415765)

回文串判断: 除了双指针，还可以将原字符串翻转，与原来的字符串相同。


#### 架构

在RPC分布式框架中，如何实现高可用，需要考虑以下几个方面：

1. 服务注册与发现：在分布式系统中，服务的地址和状态可能会发生变化，因此需要实现服务注册与发现机制，使得客户端能够动态地获取可用的服务列表。

2. 负载均衡：在分布式系统中，可能会存在多个服务提供者，需要实现负载均衡机制，使得请求能够均匀地分配到不同的服务提供者上，从而避免单点故障。

3. （与我无关）容错处理：在分布式系统中，由于网络延迟、节点故障等原因，可能会出现请求超时、连接断开等问题。因此，需要实现容错处理机制，例如重试、熔断、降级等，从而提高系统的可用性。

4. 集群管理：在分布式系统中，可能会存在多个服务节点组成的集群，需要实现集群管理机制，例如主从切换、选举机制等，从而保证系统的高可用性。

5. 监控与告警：在分布式系统中，需要实现监控与告警机制，及时发现和解决系统故障，从而提高系统的可用性和稳定性。

#### 设计一个高并发服务器

设计高并发的服务器需要考虑多个方面，包括硬件、软件、网络、安全等方面。以下是一些常见的设计策略：

- 硬件方面：选择高性能的服务器硬件，包括CPU、内存、存储和网络设备。可以考虑使用分布式存储系统和负载均衡器等技术来提高性能和可靠性。

- 软件方面：选择高性能的操作系统和数据库软件，并进行优化和配置。可以考虑使用缓存技术、异步处理、多线程等技术来提高性能。

- 网络方面：优化网络架构，包括网络拓扑、路由、负载均衡和安全等方面。可以考虑使用CDN、反向代理、防火墙等技术来提高性能和安全性。（负载均衡）

- 安全方面：采用多层次的安全策略，包括身份验证、访问控制、数据加密和安全审计等方面。可以考虑使用SSL、VPN、IDS等技术来提高安全性。

缓存、负载均衡、多线程异步处理、熔断机制等


高并发实现高可用
要实现高并发和高可用，可以考虑以下几个方面：

- 分布式架构：采用分布式架构，将系统拆分成多个独立的子系统，每个子系统可以独立运行、扩展和升级，从而提高系统的并发能力和可用性。

- 负载均衡：采用负载均衡技术，将请求分发到多个服务器上，从而均衡服务器负载，提高系统的并发能力和可用性。可以使用硬件负载均衡器或软件负载均衡器，如Nginx、HAProxy等。

- 缓存技术：使用缓存技术，将常用的数据和计算结果缓存到内存或分布式缓存中，从而减少对数据库和服务器的访问，提高系统的并发能力和可用性。可以使用Redis、Memcached等缓存技术。

- 异步处理：采用异步处理技术，将请求异步处理，从而提高系统的并发能力和可用性。可以使用消息队列、异步任务等技术，如RabbitMQ、Kafka等。

- 监控和容灾：实时监控系统的性能和状态，及时发现和解决问题。采用容灾技术，如备份、冗余、集群等，提高系统的可用性和稳定性。

分布式子系统、负载均衡、缓存技术、异步处理、容灾


#### 网络

http加密算法   =>  防止数据被偷取后篡改

首先，数据传输不能用非对称加密算法加密（会使得数据传输量变很大，加解密效率低），所以公钥数据传输需要协商一种对称加密方式：

- 客户端发起连接，将自己支持的加密算法发送给服务器
- 服务器选择一种加密算法，并生成一对公钥和私钥
- 客户端生成该算法的一个随机密钥，利用公钥加密，发送给服务器
- 服务器用公钥解密，得到这个随机密钥
 
摘要算法   =>   防止数据被直接篡改

发送的数据库包括两部分，用哈希函数计算要发送的数据，作为摘要置于数据的尾部，然后接收端用同样的哈希函数计算数据部分，如果和摘要不同，那说明这个数据包被篡改过



#### mysql

[索引下推](https://baijiahao.baidu.com/s?id=1751370960914093791&wfr=spider&for=pc)

一个联合索引，如果只走了其中一部分的索引，那么就可以减少回表的次数

如联合索引a,b,c 查询条件为where a=1 and c like '%2', 那么查询到a=1的记录时，不会立马回表，而是会判断当前索引行的c是否满足%2.(注意，如果
条件是 where a=1 and c =2，也会走索引a，记录a=1的位置，然后继续查询索引a=1的位置，最后判断这些位置的c是否等于2)


## 面试

刷面经还是挺有用的，就是忘记录音了

1. 问项目，问的比较简单
2. 智能指针了解吗
3. map和unordermp的区别
 - map用的红黑树，unordermap可以无需，用的应该是哈希表
 - 红黑树和哈希表查找速度有什么区别
   - 很傻逼的回答了哈希表的查找速度为O(log)了，然后我说红黑树的查找速度比较稳定，哈希表如果哈希链比较长，查找速度会变慢
 - 既然说到了红黑树，它和平衡二叉树有什么区别？
   - 平衡二叉树查找速度不稳定，在极端情况下，查找速度为O(n),而红黑树的最短树枝为最长树枝的一半，有较稳定的查找效率
 - 那平衡二叉树的红黑树的最大高度差为多少
   - n-log(n)...面试官没说话了
4. 有用过什么排序算法吗？
    - 刷面经富途爱考归并排序，但是没怎么用，心里没底，说了快排
      - 快排的时间复杂度为nlog(n),但最坏情况下效率为n^2
    - 快排是稳定的吗，为什么
      - 不是稳定的，因为元素之间的大小相对顺序会变化（面试官听完没继续问了）
5. Redis的zset集合用的什么数据结构
   - 是哈希吗？
   - 不是
   - 那我不知道了
   - 有序集合=> 跳表（为什么要用跳表，和红黑树比较，是西安简单，性能相当，不同场景可以获得更好的性能）
     - 插入和删除操作的时间复杂度为O(log n)，与红黑树等平衡树相当，但跳表的实现更加简单。
    - 跳表可以支持快速地查找某个元素，时间复杂度为O(log n)。
    - 跳表可以通过调整层数来平衡查询和更新的效率，可以在不同的场景下获得更好的性能。
    - 跳表可以使用简单的算法来实现，而且比其他数据结构更容易理解和实现。
- kafaka用过吗？
  - 我自己学过
  - 消息者数量比partition数量多怎么办？
  - 不知道
  - vcks参数是什么
  - 不知道
6. mysql索引了解吗？
   - 如果建了一个索引(a,b,c),那么查找a,c会走索引吗？    
   - 会走，当时不是很清晰，没回答好
   - select a,c 和select * 会走索引吗，哪个快
     - select * 不会走索引  =》 但其实也可以走索引的，面试官应该是想考我回表，没有反应过来
   - 为什么有时候加了索引，查询速度还是很慢
     - 索引为男和女这种区分度不高的
     - 多表连接（并不是）
     - 回表次数太多
     - 其实面试官这里真正想考的是索引失效的情况[参考链接](https://www.zhihu.com/question/536974445/answer/3157203248?utm_id=0)
   - 既然说到回表，为什么会进行回表
     - 查询的字段并不是全部在索引表中存在
7. 网络字节序分大小端吗？为什么
   - 分吧，为什么不知道    =》 考的是网络的收发
   - 网络字节序规定了字节顺序的标准，无论计算机的体系结构是大端序还是小端序，都需要将数据转换为网络字节序才能在网络上传输。这是因为在网络上传输数据时，发送方和接收方的计算机体系结构可能不同，如果不使用网络字节序进行转换，
   - 就会导致接收方无法正确解析数据，
   - 因此，网络字节序不分大小端，而是规定了一种固定的字节顺序，即高位字节在前、低位字节在后的大端序字节顺序。这样，在网络上传输数据时，发送方和接收方都可以按照这种字节顺序进行数据解析，保证数据的正确传输。
   - socket返回的状态码返回0表示什么，=-1表示什么
     - 返回0表示连接成功吧。 socket返回的状态码为0通常表示连接已关闭。这意味着在连接过程中出现了某些问题，导致连接被中断或关闭。
     - socket返回的状态码为-1通常表示出现了错误。这意味着在连接或传输过程中出现了某些问题，导致操作无法完成。具体的错误信息需要通过调用系统函数的errno变量来获取。常见的错误包括连接超时、连接被重置、连接被拒绝等
8. 压测的时候，程序跑不起来有什么原因
    - 可能刚跑的时候，把线程都堵死了，，
    - 还有什么原因？
      - 不知道
9. protobuf用过吗？require和object表示什么
   - require表示请求，message表示类
   - object是message的
   - 不知道了
10. 做个题吧：
   - 简单等级：[力扣链接](https://leetcode.cn/problems/fan-zhuan-dan-ci-shun-xu-lcof/)
   - 用栈吧
   - 嗯嗯，
   - 是不是还有其他方法，翻转两次，是的，你在自己的环境上编译运行下
   - 写的时候交换那里没考虑清除，没写出来